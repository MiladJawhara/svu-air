import{d as R,c as $,b as Q,a as k,Q as A}from"./QCard.3cfc97d9.js";import{j as B,r as w,ac as F,ad as P,o as T,h as j,k as O,g as D,at as M,E,n as N,I as U,a8 as K,M as L,K as z,a1 as G,a2 as H,d,O as p,au as J,Q as W,S as I,a5 as X,av as V,R as Y,ae as Z}from"./index.74c24860.js";import{api as ee}from"./axios.f9b45ab4.js";import"./format.9f771de1.js";var te=B({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validation-success","validation-error"],setup(m,{slots:h,emit:b}){const n=D(),f=w(null);let s=0;const o=[];function x(e){const i=typeof e=="boolean"?e:m.noErrorFocus!==!0,g=++s,_=(a,u)=>{b("validation-"+(a===!0?"success":"error"),u)},q=a=>{const u=a.validate();return typeof u.then=="function"?u.then(c=>({valid:c,comp:a}),c=>({valid:!1,comp:a,err:c})):Promise.resolve({valid:u,comp:a})};return(m.greedy===!0?Promise.all(o.map(q)).then(a=>a.filter(u=>u.valid!==!0)):o.reduce((a,u)=>a.then(()=>q(u).then(c=>{if(c.valid===!1)return Promise.reject(c)})),Promise.resolve()).catch(a=>[a])).then(a=>{if(a===void 0||a.length===0)return g===s&&_(!0),!0;if(g===s){const{comp:u,err:c}=a[0];if(c!==void 0&&console.error(c),_(!1,u),i===!0){const C=a.find(({comp:S})=>typeof S.focus=="function"&&M(S.$)===!1);C!==void 0&&C.comp.focus()}}return!1})}function l(){s++,o.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function r(e){e!==void 0&&E(e);const i=s+1;x().then(g=>{i===s&&g===!0&&(m.onSubmit!==void 0?b("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function t(e){e!==void 0&&E(e),b("reset"),N(()=>{l(),m.autofocus===!0&&m.noResetFocus!==!0&&v()})}function v(){R(()=>{if(f.value===null)return;const e=f.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(f.value.querySelectorAll("[tabindex]"),i=>i.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}U(K,{bindComponent(e){o.push(e)},unbindComponent(e){const i=o.indexOf(e);i>-1&&o.splice(i,1)}});let y=!1;return F(()=>{y=!0}),P(()=>{y===!0&&m.autofocus===!0&&v()}),T(()=>{m.autofocus===!0&&v()}),Object.assign(n.proxy,{validate:x,resetValidation:l,submit:r,reset:t,focus:v,getValidationComponents:()=>o}),()=>j("form",{class:"q-form",ref:f,onSubmit:r,onReset:t},O(h.default))}});const ae={class:"row justify-center items-center full-height q-pa-md"},oe={class:"col col-sm-8 col-md-6 col-lg-4"},ne=I(" Add "),de=L({__name:"AddQuestionPage",setup(m){const h=J(),b=[{languageId:1,text:"English"},{languageId:2,text:"Arabic"}],n=z({text:"",answer:"",language_id:b[0].languageId}),f=w(null),s=w(null);let o=w(!1);const x=async()=>{var t,v,y,e,i,g;if((t=f.value)==null||t.validate(),(v=s.value)==null||v.validate(),((y=f.value)==null?void 0:y.hasError)||((e=s.value)==null?void 0:e.hasError)){h.notify({message:"Make sure to fill all required fields!",color:"red",position:"bottom-left"});return}o.value=!0;const{data:l,status:r}=await ee.post("/questions",n);r==201&&((i=f.value)==null||i.resetValidation(),(g=s.value)==null||g.resetValidation(),n.text="",n.answer="",h.notify({message:"The question successfully added",color:"positive",position:"bottom-left"})),o.value=!1};return(l,r)=>(W(),G("div",ae,[H("div",oe,[d($,{class:"full-width"},{default:p(()=>[d(Q,{class:"text-h4"},{default:p(()=>[I(X(l.$t("Add new question")),1)]),_:1}),d(Q,null,{default:p(()=>[d(te,null,{default:p(()=>[d(V(A),{ref_key:"textRef",ref:f,rules:[t=>!!t||l.$t("Text is required")],name:"text",outlined:"",modelValue:n.text,"onUpdate:modelValue":r[0]||(r[0]=t=>n.text=t),type:"text",label:l.$t("Text")},null,8,["rules","modelValue","label"]),d(V(A),{ref_key:"answerRef",ref:s,rules:[t=>!!t||l.$t("Answer is required")],name:"answer",outlined:"",modelValue:n.answer,"onUpdate:modelValue":r[1]||(r[1]=t=>n.answer=t),type:"textarea",label:l.$t("Answer")},null,8,["rules","modelValue","label"]),d(k,{name:"language_id",rules:[t=>!!t||l.$t("Language is required")],label:l.$t("Language"),modelValue:n.language_id,"onUpdate:modelValue":r[2]||(r[2]=t=>n.language_id=t),options:b,"option-label":"text","emit-value":"","option-value":"languageId","map-options":""},null,8,["rules","label","modelValue"])]),_:1})]),_:1}),d(Q,null,{default:p(()=>[d(Y,{class:"full-width",disable:V(o),loading:V(o),onClick:x,color:"primary"},{loading:p(()=>[d(Z)]),default:p(()=>[ne]),_:1},8,["disable","loading"])]),_:1})]),_:1})])]))}});export{de as default};
